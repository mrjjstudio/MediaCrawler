# 批量公司聯絡資料搜索系統

## 系統概述

這是一個自動化的批量公司聯絡資料搜索系統，能夠從公司列表中提取每家公司的聯絡資料，包括電話、郵箱、地址等信息。

## 功能特點

- ✅ 批量處理大量公司
- ✅ 自動搜索和提取聯絡資料
- ✅ 智能等待和重試機制
- ✅ 進度保存和恢復功能
- ✅ 多種配置選項
- ✅ 支持多個郵箱地址
- ✅ 自動保存為CSV格式
- ✅ 反反爬蟲機制

## 安裝說明

### 1. 安裝依賴

```bash
python install_dependencies.py
```

### 2. 檢查文件

確保以下文件存在：
- `companylist2.md` - 公司列表文件
- `batch_company_search.py` - 主搜索腳本
- `run_batch_search.py` - 啟動腳本

## 使用方法

### 啟動系統

```bash
python run_batch_search.py
```

### 主選單功能

1. **開始批量搜索** - 開始全新的批量搜索
2. **查看搜索配置** - 查看當前配置參數
3. **修改搜索配置** - 調整搜索參數
4. **查看搜索進度** - 查看已完成的搜索進度
5. **繼續未完成的搜索** - 恢復中斷的搜索
6. **清除所有進度** - 清空搜索歷史
7. **測試搜索功能** - 測試單個公司搜索
0. **退出** - 退出系統

## 配置說明

### 主要配置參數

- **delay_between_searches**: 搜索間隔時間（建議5-10秒）
- **max_wait_time**: 最大等待時間（建議60-120秒）
- **auto_save_interval**: 自動保存間隔（每N個公司）
- **max_retries**: 最大重試次數
- **start_from_index**: 從指定位置開始搜索

### 推薦配置

```json
{
  "delay_between_searches": 5,
  "max_wait_time": 60,
  "auto_save_interval": 10,
  "max_retries": 3,
  "start_from_index": 0
}
```

## 輸出格式

### CSV文件字段

- **company_name**: 公司名稱
- **phone**: 聯絡電話
- **email**: 郵箱地址（多個用分號分隔）
- **address**: 公司地址
- **legal_representative**: 法定代表人
- **registered_capital**: 註冊資本
- **established_date**: 成立日期
- **business_scope**: 經營範圍

### 輸出文件

- `batch_company_contacts_YYYYMMDD_HHMMSS.csv` - 最終結果
- `batch_progress_N.csv` - 進度保存文件
- `search_progress.json` - 搜索進度記錄

## 時間估算

- 每個公司處理時間：約70秒（包括等待時間）
- 100家公司：約2小時
- 1000家公司：約20小時
- 建議分批處理或調整配置

## 注意事項

### 運行建議

1. **網絡連接**: 確保網絡穩定
2. **長時間運行**: 建議在穩定的環境中運行
3. **定期檢查**: 可以隨時中斷並恢復搜索
4. **數據備份**: 定期備份進度文件

### 常見問題

**Q: 搜索速度太慢怎麼辦？**
A: 可以調整配置中的 `delay_between_searches` 參數，但不建議設置過低以避免被封鎖。

**Q: 搜索中斷了怎麼辦？**
A: 使用選單中的"繼續未完成的搜索"功能，系統會自動從中斷處恢復。

**Q: 如何跳過某些公司？**
A: 可以修改配置中的 `start_from_index` 參數，從指定位置開始搜索。

**Q: 沒有找到某些公司的資料怎麼辦？**
A: 這是正常現象，系統會記錄成功率，無法找到的公司會在CSV中保留空白。

## 技術原理

### 搜索機制

1. 使用百度AI聊天搜索API
2. 自動化瀏覽器控制（Playwright）
3. 智能等待AI回復完成
4. 正則表達式提取聯絡資料

### 反反爬蟲技術

- 隱藏自動化特徵
- 隨機等待時間
- 真實瀏覽器環境
- 智能重試機制

## 系統要求

- Python 3.8+
- Windows 10+ / macOS / Linux
- 穩定的網絡連接
- 至少2GB可用內存

## 故障排除

### 常見錯誤

1. **ImportError**: 運行 `python install_dependencies.py`
2. **TimeoutError**: 檢查網絡連接，增加等待時間
3. **BrowserError**: 重新安裝瀏覽器：`playwright install chromium`

### 日誌文件

系統會在控制台輸出詳細的運行日誌，包括：
- 搜索進度
- 錯誤信息
- 成功率統計

## 許可證

本系統僅供學習和研究使用，請遵守相關網站的使用條款。

## 更新日誌

- v1.0.0: 初始版本
- 支持批量搜索
- 支持多郵箱地址
- 支持進度保存和恢復 